<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>æµ·å¤§æ ¡å›­å¢™</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <style>
        /* === 1. é¡µé¢ï¼šå…¨å±ç°è‰²èƒŒæ™¯ === */
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: "Microsoft YaHei", 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial, sans-serif;
            overflow: hidden;
        }

        #page {
            width: 100vw;
            height: 100vh;
            background-color: #e8e8e8;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* === 2. äº’åŠ¨ç•Œé¢ï¼šä¸¥æ ¼4:3ï¼Œå°äºé¡µé¢ === */
        #ui {
            width: 80vw;
            max-width: 960px;
            height: calc(80vw * 3 / 4);
            max-height: 720px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* === 3. å†…å®¹åŒº === */
        #content-area {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* ===== å·¦ä¾§èŠå¤©åˆ—è¡¨ï¼šå®½åº¦å æ¯” 30% (3:7æ¯”ä¾‹ä¸­çš„3) ===== */
        #sidebar {
            width: 30%;
            /* å·¦ä¾§å 30% */
            background: #f8f8f8;
            border-right: 1px solid #e6e6e6;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .chat-item {
            padding: 14px 16px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background 0.2s;
        }

        .chat-item:hover {
            background: #ededed;
        }

        .chat-item.active {
            background: #e5e5e5;
        }

        .avatar {
            width: 42px;
            height: 42px;
            border-radius: 6px;
            margin-right: 12px;
            flex-shrink: 0;
            object-fit: cover;
            /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹å¹¶å¡«æ»¡ */
        }

        .chat-info {
            flex: 1;
            min-width: 0;
        }

        .chat-name {
            font-weight: 500;
            color: #222;
            font-size: 15px;
        }

        .preview {
            color: #888;
            font-size: 13px;
            margin-top: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* ===== å³ä¾§ä¸»æ˜¾ç¤ºåŒºï¼šå®½åº¦å æ¯” 70% (3:7æ¯”ä¾‹ä¸­çš„7) ===== */
        #main-display {
            width: 70%;
            /* å³ä¾§å 70% */
            display: flex;
            flex-direction: column;
            background: white;
            overflow: hidden;
        }

        /* èŠå¤©åŒºåŸŸå¤´éƒ¨ */
        .chat-header {
            padding: 16px 20px;
            border-bottom: 1px solid #e6e6e6;
            font-weight: 500;
            font-size: 16px;
            color: #222;
            background: #fcfcfc;
            flex-shrink: 0;
        }

        /* æ¶ˆæ¯åŒºåŸŸ */
        .message-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f5f5f7;
            display: flex;
            flex-direction: column;
        }

        .message {
            display: flex;
            margin-bottom: 18px;
        }

        .message-them {
            justify-content: flex-start;
        }

        .message-me {
            justify-content: flex-end;
        }

        /* æ¶ˆæ¯å¤´åƒ */
        .msg-avatar {
            width: 44px;
            height: 44px;
            border-radius: 8px;
            flex-shrink: 0;
            object-fit: cover;
            /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹å¹¶å¡«æ»¡ */
        }

        /* æˆ‘æ–¹å¤´åƒä¸ä¸ªäººé¡µé¢å¤´åƒä¸€è‡´ */
        .msg-avatar.me {
            background: linear-gradient(45deg, #f6b1b1, #f08b8b);
        }

        /* èŠå¤©æ¶ˆæ¯ä¸å¤´åƒå‚ç›´å±…ä¸­ */
        .message {
            align-items: center;
        }

        .message-them .bubble {
            margin-left: 12px;
        }

        .message-me .bubble {
            margin-right: 12px;
        }

        .bubble {
            max-width: 70%;
            padding: 10px 14px;
            border-radius: 6px;
            line-height: 1.5;
            word-wrap: break-word;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .message-them .bubble {
            background: white;
            border: 1px solid #e1e1e1;
            color: #333;
        }

        .message-me .bubble {
            background: #FCBEC3;
            color: #222;
        }

        /* ===== åº•éƒ¨å¯¼èˆª ===== */
        #bottom-nav {
            display: flex;
            height: 60px;
            background: #f8f8f8;
            border-top: 1px solid #e6e6e6;
            flex-shrink: 0;
        }

        .nav-icon {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            color: #666;
            transition: all 0.2s;
        }

        .nav-icon:hover {
            background-color: #f0f0f0;
            color: #333;
        }

        .nav-icon.active {
            color: #FCBEC3;
        }

        .nav-icon i {
            font-size: 20px;
            margin-bottom: 4px;
        }

        /* ===== â€œæœ‹å‹åœˆâ€å’Œâ€œæˆ‘â€çš„ç•Œé¢ï¼ˆé»˜è®¤éšè—ï¼‰===== */
        .page {
            display: none;
            flex: 1;
            flex-direction: column;
            overflow: hidden;
        }

        .page.active {
            display: flex;
        }

        #chat-page.active {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        #chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f5f5f7;
            display: flex;
            flex-direction: column;
        }

        /* æœ‹å‹åœˆé¡µé¢æ¨¡æ‹Ÿ */
        .moments-item {
            position: relative;
            padding: 18px 20px;
            margin-bottom: 14px;
            background: #FCBEC3;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
            line-height: 1.7;
            /* æé«˜è¡Œé«˜ä»¥æ”¹å–„å¯è¯»æ€§ */
        }

        /* æ·»åŠ ç”Ÿæ´»åœˆåŒºåŸŸæ ·å¼ */
        #moments-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f5f5f7;
            display: flex;
            flex-direction: column;
            gap: 14px;
            min-height: 0;
        }

        .moments-item {
            position: relative;
            padding: 18px 20px;
            background: #FCBEC3;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
            line-height: 1.7;
            flex-shrink: 0;
        }

        .moments-item>div,
        .moments-item>p {
            line-height: 1.7;
            /* æ ‡é¢˜ä¸æ®µè½ç»Ÿä¸€è¡Œé«˜ */
        }

        .moments-item p {
            margin-top: 10px;
            margin-bottom: 0;
        }

        /* æœ‹å‹åœˆé¡¶éƒ¨è¾“å…¥åŒºåŸŸ */
        .moments-input-container {
            display: flex;
            gap: 10px;
            padding: 12px 16px;
            align-items: center;
            border-bottom: 1px solid #eee;
            background: #fff;
        }

        .moments-input-container textarea {
            flex: 1;
            resize: vertical;
            min-height: 64px;
            max-height: 160px;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #e6e6e6;
            font-size: 14px;
            font-family: inherit;
            line-height: 1.4;
        }

        .moments-input-container .paper-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: #FCBEC3;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            color: #fff;
            font-size: 16px;
        }

        .moments-item .trash-btn {
            position: absolute;
            right: 10px;
            top: 10px;
            width: 34px;
            height: 34px;
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.06);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #555;
            border: none;
            z-index: 10;
        }

        .moments-item .trash-btn:hover {
            background: rgba(0, 0, 0, 0.12);
        }

        /* ç¡®è®¤å¯¹è¯æ¡† */
        .confirm-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .confirm-modal {
            background: #fff;
            border-radius: 10px;
            width: 320px;
            max-width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .confirm-body {
            padding: 18px;
            font-size: 15px;
            color: #333;
            text-align: center;
        }

        .confirm-footer {
            padding: 12px;
            display: flex;
            gap: 10px;
            justify-content: center;
            border-top: 1px solid #f0f0f0;
        }

        .confirm-btn {
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #ddd;
            background: #fafafa;
            font-weight: 600;
        }

        .confirm-btn.delete {
            background: #f66;
            color: #fff;
            border-color: rgba(0, 0, 0, 0.06);
        }

        .hidden {
            display: none !important;
        }

        /* èŠå¤©è®°å½•é¡¶éƒ¨æ—¶é—´å±•ç¤º */
        .chat-time {
            text-align: center;
            padding: 12px 0;
            margin-top: -16px;
            font-size: 15px;
            color: #888;
            background: transparent;
        }

        /* â€œæˆ‘â€çš„é¡µé¢æ¨¡æ‹Ÿ */
        .profile-page {
            align-items: center;
            padding-top: 40px;
            background: linear-gradient(to bottom, #fcfcfc 30%, #f5f5f5 30%);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            background: #ccc;
            margin-bottom: 15px;
        }

        /* è´¦å·ç®¡ç†ä¸ç™»å½•æ ·å¼ */
        .link-btn {
            background: none;
            border: none;
            color: #222;
            padding: 8px 10px;
            font-size: 14px;
            cursor: pointer;
        }

        .account-overlay {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }

        .account-modal {
            background: #fff;
            border-radius: 10px;
            width: 360px;
            max-width: 92%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .account-list {
            display: flex;
            flex-direction: column;
        }

        .account-item {
            padding: 14px 18px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
        }

        .account-item.danger {
            color: #e74c3c;
            font-weight: 600;
        }

        .btn {
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #ddd;
            background: #fafafa;
            font-weight: 600;
        }

        .btn.primary {
            background: #FCBEC3;
            border-color: rgba(0, 0, 0, 0.06);
        }

        .overlay-backdrop {
            position: fixed;
            inset: 0;
            background: transparent;
        }

        .hidden {
            display: none !important;
        }

        /* èŠå¤©è¾“å…¥æ¡†æ ·å¼ */
        .chat-input-container {
            display: flex;
            padding: 12px;
            background: #fff;
            border-top: 1px solid #eee;
            align-items: flex-end;
        }

        #chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            resize: none;
            max-height: 120px;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.4;
        }

        .send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #FCBEC3;
            border: none;
            color: #fff;
            margin-left: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
        }

        .send-btn:hover {
            background: #f9a3aa;
        }

        /* ===== æœªè¯»æ¶ˆæ¯çº¢ç‚¹ ===== */
        .unread-dot {
            display: none;
            width: 10px;
            height: 10px;
            background-color: #ff3b30;
            border-radius: 50%;
            margin-left: 8px;
            flex-shrink: 0;
        }

        .unread-dot.show {
            display: block;
        }

        /* ===== ç”Ÿæ´»åœˆè¯„è®ºæ ·å¼ ===== */
        .comments-container {
            margin-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            padding-top: 10px;
        }

        .comments-list {
            margin-bottom: 10px;
        }

        .comment-item {
            padding: 8px 0;
            font-size: 14px;
            color: #333;
            line-height: 1.5;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .comment-item:last-child {
            border-bottom: none;
        }

        .comment-author {
            font-weight: 600;
            color: #555;
            cursor: pointer;
        }

        .comment-author:hover {
            color: #FCBEC3;
        }

        .comment-reply {
            color: #666;
            font-size: 12px;
            margin-left: 8px;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.05);
        }

        .comment-reply:hover {
            color: #FCBEC3;
            background: rgba(252, 190, 195, 0.1);
        }

        .comment-input-container {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            align-items: center;
        }

        .comment-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 13px;
            font-family: inherit;
            outline: none;
            resize: none;
            min-height: 36px;
            line-height: 1.4;
            box-sizing: border-box;
        }

        .comment-input:focus {
            border-color: #FCBEC3;
            box-shadow: 0 0 0 2px rgba(252, 190, 195, 0.2);
        }

        .comment-send-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #FCBEC3;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            flex-shrink: 0;
        }

        .comment-send-btn:hover {
            background: #f9a3aa;
        }

        .comment-send-btn i {
            font-size: 14px;
            transform: rotate(90deg);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <div id="page">
        <div id="ui">
            <div id="content-area">
                <!-- å·¦ä¾§èŠå¤©åˆ—è¡¨ (30%) -->
                <div id="sidebar">
                    <div class="chat-item active" onclick="switchToChat('qun', this)">
                        <div class="avatar"></div>
                        <div class="chat-info">
                            <div class="chat-name">ç‹‚å–æµ·æ°´ä¸‰åƒå¨ï¼Œååˆ°æµ·æ»¡æ¢å­¦åˆ† (5)</div>
                            <div class="preview">å¯†ç çš„ï¼Œä½ æ”¹äº†å€’æ˜¯è¯´ä¸€å£°å•Šå¯†ç çš„</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('beiguo', this)">
                        <img src="pfp/beiguo.jpg" class="avatar" alt="è´æœå¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">ğŸ¥¯ğŸ¥¯</div>
                            <div class="preview">å¢™å¢™æŠ•ç¨¿ï¼å­¦é•¿ç»å¸¸æ¥412æ•™å®¤å·¡é€»ï¼Œå»412ä¸Šè¯¾çš„åŒå­¦å¯ä»¥ç»™å­¦é•¿å¸¦ç‚¹é›¶é£Ÿï¼åŒ¿äº†è°¢è°¢å¢™ï¼</div>
                        </div>
                        <div class="unread-dot" id="unread-beiguo"></div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('qi', this)">
                        <img src="pfp/ningranqi.jpg" class="avatar" alt="å®æŸ“æŸ’å¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">æŸ’æŸ’.</div>
                            <div class="preview">å¢™å¥½ æ˜æ˜éƒ½è¯´äº†ä¸œé—¨å±é™© æ€ä¹ˆæœ‰å‚»å­å¾€é‚£å»å•Š å¤©å¤©éƒ½èƒ½å¬è¯´æœ‰äººå—ä¼¤ é•¿ç‚¹å¿ƒå§å¤§å®¶ åŒ¿äº†</div>
                        </div>
                        <div class="unread-dot" id="unread-qi"></div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('xiong', this)">
                        <img src="pfp/xiong.jpg" class="avatar" alt="ç†Šå¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">ç†Šå…ˆç”Ÿä½ è¿˜æˆ‘é‡‘é³ç‰‡</div>
                            <div class="preview">
                                å·å¤–å–ä¸ºä»€ä¹ˆè¦å·è¯ï¼Ÿï¼Ÿï¼Ÿå·²ç»ç—›ç»åˆ°èµ·ä¸æ¥åºŠäº†ï¼Œç‚¹æš–å®«è´´é€åˆ°åŒ—é—¨è¿˜è¢«äººæ‹¿èµ°äº†ï¼Œå·²åˆ°è¾¾ä¸€å…±æ²¡æœ‰äº”åˆ†é’Ÿï¼Œä½ æŒºå¿«å•Šï¼Œæˆ‘ä¸çŸ¥é“è¿™ä¸ªæš–å®«è´´ä½ æ‰“ç®—æ€ä¹ˆåƒï¼Œæ‹†å¼€ç²‰åŒ…å†…æœå—ï¼Ÿä½ åˆ°åº•æ˜¯æ€ä¹ˆæƒ³çš„ï¼Ÿï¼Ÿï¼Ÿ
                            </div>
                        </div>
                        <div class="unread-dot" id="unread-xiong"></div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('zhamao', this)">
                        <img src="pfp/zhamao.jpg" class="avatar" alt="ç‚¸æ¯›å¯ä¹å¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">ç‚¸æ¯›å¯ä¹</div>
                            <div class="preview">æ”¶åˆ°</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('xiaoyan', this)">
                        <img src="pfp/xiaoyan.jpg" class="avatar" alt="å°è¨€å¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">å°è¨€ä¸é—²</div>
                            <div class="preview">æ”¶åˆ°</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('yuhang', this)">
                        <img src="pfp/yuhang.jpg" class="avatar" alt="å®‡èˆªå¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">å®‡èˆªæ¬§å·´çš„WeChat</div>
                            <div class="preview">[å›¾ç‰‡]</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('empurple', this)">
                        <img src="pfp/empurple.jpg" class="avatar" alt="empurple">
                        <div class="chat-info">
                            <div class="chat-name">Empurple</div>
                            <div class="preview">æ”¶åˆ°ï¼</div>
                        </div>
                    </div>

                    <div class="chat-item" onclick="switchToChat('aaa', this)">
                        <img src="pfp/aaa.jpg" class="avatar" alt="AAAå¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">AAAé²ˆé±¼æ‰¹å‘å•†</div>
                            <div class="preview">æ”¶åˆ°</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('caoyoumei', this)">
                        <img src="pfp/cao.jpg" class="avatar" alt="è‰åˆè“äº†å¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">è‰åˆè“äº†</div>
                            <div class="preview">æ”¶åˆ°</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('xian', this)">
                        <img src="pfp/xian.jpg" class="avatar" alt="ä»™-ä¸­çš„ä¿®ä»™äººå¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">ä»™-ä¸­çš„ä¿®ä»™äºº</div>
                            <div class="preview">æ”¶åˆ°</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="switchToChat('yuwensi', this)">
                        <img src="pfp/yuwensi.jpg" class="avatar" alt="å­¦ä¸ä¼šå¤´åƒ">
                        <div class="chat-info">
                            <div class="chat-name">å­¦ä¸ä¼š</div>
                            <div class="preview">åŒå­¦ä½ å¥½</div>
                        </div>
                    </div>
                </div>

                <!-- å³ä¾§ä¸»æ˜¾ç¤ºåŒº (70%) -->
                <div id="main-display">
                    <div id="chat-page" class="page active">
                        <!-- è¿™é‡Œç•™ç©ºï¼Œç”± switchToChat() è‡ªåŠ¨å¡«å…… -->
                        <div class="chat-header" id="chat-header"></div>
                        <div class="message-area" id="chat-messages"></div>
                        <div class="chat-input-container">
                            <textarea id="chat-input" placeholder="è¾“å…¥æ¶ˆæ¯...ï¼ˆæŒ‰ Enter å‘é€ï¼ŒShift+Enter æ¢è¡Œï¼‰"></textarea>
                            <button id="chat-send" class="send-btn" title="å‘é€"><i
                                    class="fas fa-level-down-alt"></i></button>
                        </div>
                    </div>

                    <div id="moments-page" class="page">
                        <div class="chat-header">ç”Ÿæ´»åœˆ</div>
                        <div class="moments-input-container">
                            <textarea id="moments-input"
                                placeholder="åœ¨ç”Ÿæ´»åœˆå‘è¡¨ç‚¹ä»€ä¹ˆ...ï¼ˆæŒ‰ Enter å‘é€ï¼ŒShift+Enter æ¢è¡Œï¼‰"></textarea>
                            <button id="moments-send" class="paper-btn" title="å‘é€"><i
                                    class="fas fa-paper-plane"></i></button>
                        </div>
                        <div class="message-area" id="moments-area">
                            <div class="moments-item">
                                <div><strong>AAAé²ˆé±¼æ‰¹å‘å•†</strong> 10æœˆ12æ—¥</div>
                                <p>æŠ¢åˆ°ä¼Šè€å¸ˆçš„é€‰ä¿®è¯¾äº†...ï¼ä¼Šå†·è€å¸ˆæˆ‘çš„å¥³ç¥ï¼</p>
                            </div>
                            <div class="moments-item">
                                <div><strong>æµ·å¤§æ ¡å›­å¢™</strong> 10æœˆ11æ—¥</div>
                                <p>æœ‰åŒå­¦è·¯è¿‡ä¸œé—¨è¢«æ‰ä¸‹æ¥çš„ä¸œè¥¿ç ¸ä¼¤äº†ï¼Œå¥½åœ¨ä¼¤åŠ¿ä¸ä¸¥é‡ï¼Œå¤§å®¶ä¸€å®šä¸è¦å‰å¾€ä¸œé—¨ï¼Œå°½é‡ç»•è·¯èµ°ï¼Œå¤§å®¶æ³¨æ„å®‰å…¨ï¼</p>

                                <div class="comments-container">
                                    <div class="comments-list">
                                        <div class="comment-item">
                                            <span class="comment-author">è‰åˆè“äº†</span>: å•¥ç©æ„æ‰ä¸‹æ¥äº†
                                            <span class="comment-reply" onclick="replyToComment(this)">å›å¤</span>
                                        </div>
                                        <div class="comment-item">
                                            <span class="comment-author">å®‡æ–‡å¸</span>: æˆ‘æ“éƒ½ç»™åŠæ‹‰èº«å­ç ¸æ‰äº†
                                            <span class="comment-reply" onclick="replyToComment(this)">å›å¤</span>
                                        </div>
                                        <div class="comment-item">
                                            <span class="comment-author">Empurple</span>: ä¸œæ¥¼ä¸æ˜¯æ–°å»ºçš„å—......
                                            <span class="comment-reply" onclick="replyToComment(this)">å›å¤</span>
                                        </div>
                                        <div class="comment-item">
                                            <span class="comment-author">ç‚¸æ¯›å¯ä¹</span>: å¢™ä½ ä¸ºä»€ä¹ˆä¸å›æˆ‘
                                            <span class="comment-reply" onclick="replyToComment(this)">å›å¤</span>
                                        </div>
                                    </div>

                                    <!-- è¯„è®ºè¾“å…¥æ¡† -->
                                    <div class="comment-input-container">
                                        <input type="text" class="comment-input" placeholder="æ·»åŠ è¯„è®º...">
                                        <button class="comment-send-btn" title="å‘é€"><i
                                                class="fas fa-level-down-alt"></i></button>
                                    </div>
                                </div>

                                <button class="trash-btn" title="åˆ é™¤"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>

                    <div id="profile-page" class="page profile-page">
                        <div class="profile-avatar"></div>
                        <div style="font-size:18px; margin-bottom:5px;">æµ·å¤§æ ¡å›­å¢™</div>

                        <div style="width:100%; padding:0 20px;">
                            <div style="padding:15px 0; border-bottom:1px solid #eee; padding-left:15px;">
                                <strong>æˆ‘çš„æ”¶è—</strong></div>
                            <div style="padding:15px 0; border-bottom:1px solid #eee; padding-left:15px;">
                                <strong>éšç§å®‰å…¨</strong></div>
                            <div style="padding:15px 0; border-bottom:1px solid #eee; padding-left:15px;">
                                <strong>è®¾ç½®</strong></div>
                            <div style="padding:15px 0; border-bottom:1px solid #eee; padding-left:15px;">
                                <strong id="account-manage-btn" style="cursor: pointer;"
                                    onclick="document.getElementById('account-overlay').classList.remove('hidden')">è´¦å·ç®¡ç†</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="bottom-nav">
                <div class="nav-icon active" onclick="switchTab('chat')">
                    <i class="fas fa-comment"></i><span>èŠå¤©</span>
                </div>
                <div class="nav-icon" onclick="switchTab('moments')">
                    <i class="fas fa-camera"></i><span>ç”Ÿæ´»åœˆ</span>
                </div>
                <div class="nav-icon" onclick="switchTab('profile')">
                    <i class="fas fa-user"></i><span>æˆ‘</span>
                </div>
            </div>
        </div>
    </div>
    <script>
        // æ˜¾ç¤ºæœªè¯»çº¢ç‚¹
        function showUnreadDot(chatId) {
            const dot = document.getElementById('unread-' + chatId);
            if (dot) dot.classList.add('show');
        }
        // éšè—æœªè¯»çº¢ç‚¹
        function hideUnreadDot(chatId) {
            const dot = document.getElementById('unread-' + chatId);
            if (dot) dot.classList.remove('show');
        }
        // å°†å·¦ä¾§åˆ—è¡¨åå­—æˆªæ–­ï¼šå¦‚æœé•¿åº¦è¶…è¿‡ 8ï¼Œåˆ™ä¿ç•™å‰7ä¸ªå­—ç¬¦å¹¶åœ¨æœ«å°¾ç”¨ ... æ›¿ä»£ç¬¬8ä¸ªå­—ç¬¦
        function truncateNames() {
            document.querySelectorAll('.chat-name').forEach(el => {
                const txt = el.textContent.trim();
                if (txt.length > 8) {
                    el.textContent = txt.slice(0, 7) + '...';
                }
            });
        }

        function switchToChat(chat, el) {
            // åˆ‡æ¢åˆ°èŠå¤©é¡µé¢ï¼ˆæ— è®ºå½“å‰åœ¨â€œç”Ÿæ´»åœˆâ€æˆ–â€œæˆ‘â€ç•Œé¢ï¼‰
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById('chat-page').classList.add('active');
            // æ›´æ–°åº•éƒ¨å¯¼èˆªé«˜äº®åˆ°â€œèŠå¤©â€é¡¹
            document.querySelectorAll('.nav-icon').forEach(icon => icon.classList.remove('active'));
            const chatNav = document.querySelector(".nav-icon[onclick=\"switchTab('chat')\"]");
            if (chatNav) chatNav.classList.add('active');

            // ç¡®ä¿èŠå¤©è¾“å…¥æ¡†æ˜¾ç¤º
            if (typeof updateChatInputVisibility === 'function') {
                updateChatInputVisibility();
            }

            document.querySelectorAll('.chat-item').forEach(item => item.classList.remove('active'));
            if (el && el.classList) el.classList.add('active');
            // ç¡®ä¿åœ¨åˆ‡æ¢æ—¶ä¹Ÿè¿è¡Œæˆªæ–­ï¼ˆä»¥é˜²åå­—åŠ¨æ€å˜åŒ–ï¼‰
            truncateNames();

            const header = document.querySelector('#chat-page .chat-header');
            const area = document.querySelector('#chat-page .message-area');
            if (chat === 'beiguo') {
                header.innerText = 'ğŸ¥¯ğŸ¥¯';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 14:32</div>
                    <div class="message message-them">
                        <img src="pfp/beiguo.jpg" class="msg-avatar" alt="è´æœå¤´åƒ">
                        <div class="bubble">å¢™å¢™æŠ•ç¨¿ï¼å­¦é•¿ç»å¸¸æ¥412æ•™å®¤å·¡é€»ï¼Œå»412ä¸Šè¯¾çš„åŒå­¦å¯ä»¥ç»™å­¦é•¿å¸¦ç‚¹é›¶é£Ÿï¼åŒ¿äº†è°¢è°¢å¢™ï¼</div>
                    </div>
                `;
            } else if (chat === 'qi') {
                header.innerText = 'æŸ’æŸ’.';
                area.innerHTML = `
                    <div class="chat-time">2025-12-07 10:00</div>
                    <div class="message message-them">
                        <img src="pfp/ningranqi.jpg" class="msg-avatar" alt="å®æŸ“æŸ’å¤´åƒ">
                        <div class="bubble">å¢™å¥½ æ˜æ˜éƒ½è¯´äº†ä¸œé—¨å±é™© æ€ä¹ˆæœ‰å‚»å­å¾€é‚£å»å•Š å¤©å¤©éƒ½èƒ½å¬è¯´æœ‰äººå—ä¼¤ é•¿ç‚¹å¿ƒå§å¤§å®¶ åŒ¿äº†</div>
                    </div>
                `;
            } else if (chat === 'aaa') {
                header.innerText = 'AAAé²ˆé±¼æ‰¹å‘å•†';
                area.innerHTML = `
                    <div class="chat-time">2025-12-07 10:00</div>
                    <div class="message message-them">
                        <img src="pfp/aaa.jpg" class="msg-avatar" alt="aaaå¤´åƒ">
                        <div class="bubble">å¢™å¢™ä½ å¥½ï¼æˆ‘Uç›˜ä¸¢äº†ï¼Œé•¿è¿™æ ·ï¼Œæœ‰æ¡åˆ°çš„åŒå­¦è¯·è”ç³»æˆ‘ï¼ï¼æœ‰å¿ï¼ï¼ï¼</div>
                    </div>
                    <div class="message message-them">
                        <img src="pfp/aaa.jpg" class="msg-avatar" alt="aaaå¤´åƒ">
                        <div class="bubble"><img src="pic/Upan.jpg" alt="Upan" style="max-width:220px; border-radius:8px; display:block;"></div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æ”¶åˆ°</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'caoyoumei') {
                header.innerText = 'è‰åˆè“äº†';
                area.innerHTML = `
                    <div class="chat-time">2025-12-07 10:02</div>
                    <div class="message message-them">
                        <img src="pfp/cao.jpg" class="msg-avatar" alt="è‰åˆè“äº†å¤´åƒ">
                        <div class="bubble">å¢™å¢™ï¼Œæœ‰åŒå­¦è·¯è¿‡ä¸œé—¨è¢«æ‰ä¸‹æ¥çš„ä¸œè¥¿ç ¸ä¼¤äº†ï¼Œå¥½åœ¨ä¼¤åŠ¿ä¸ä¸¥é‡ï¼Œå¤§å®¶ä¸€å®šä¸è¦å‰å¾€ä¸œé—¨ï¼Œå°½é‡ç»•è·¯èµ°</div>
                    </div>
                    <div class="message message-them">
                        <img src="pfp/cao.jpg" class="msg-avatar" alt="è‰åˆè“äº†å¤´åƒ">
                        <div class="bubble">åŒ¿äº†</div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æ”¶åˆ°</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'xian') {
                header.innerText = 'ä»™-ä¸­çš„ä¿®ä»™äºº';
                area.innerHTML = `
                    <div class="chat-time">2025-12-07 10:04</div>
                    <div class="message message-them">
                        <img src="pfp/xian.jpg" class="msg-avatar" alt="ä»™-ä¸­çš„ä¿®ä»™äººå¤´åƒ">
                        <div class="bubble">æ±‚è´¢åŠ¡ç®¡ç†ç”µå­ç‰ˆæ•™æ</div>
                    </div>
                    <div class="message message-them">
                        <img src="pfp/xian.jpg" class="msg-avatar" alt="ä»™-ä¸­çš„ä¿®ä»™äººå¤´åƒ">
                        <div class="bubble"><img src="pic/wx.png" alt="wx" style="max-width:220px; border-radius:8px; display:block;"></div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æ”¶åˆ°</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'xiong') {
                header.innerText = 'ç†Šå…ˆç”Ÿä½ è¿˜æˆ‘é‡‘é³ç‰‡';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 15:00</div>
                    <div class="message message-them">
                        <img src="pfp/xiong.jpg" class="msg-avatar" alt="ç†Šå¤´åƒ">
                        <div class="bubble">å¢™ æŠ•ç¨¿</div>
                    </div>
                    <div class="message message-them">
                        <img src="pfp/xiong.jpg" class="msg-avatar" alt="ç†Šå¤´åƒ">
                        <div class="bubble">å·å¤–å–ä¸ºä»€ä¹ˆè¦å·è¯ï¼Ÿï¼Ÿï¼Ÿå·²ç»ç—›ç»åˆ°èµ·ä¸æ¥åºŠäº†ï¼Œç‚¹æš–å®«è´´é€åˆ°åŒ—é—¨è¿˜è¢«äººæ‹¿èµ°äº†ï¼Œå·²åˆ°è¾¾ä¸€å…±æ²¡æœ‰äº”åˆ†é’Ÿï¼Œä½ æŒºå¿«å•Šï¼Œæˆ‘ä¸çŸ¥é“è¿™ä¸ªæš–å®«è´´ä½ æ‰“ç®—æ€ä¹ˆåƒï¼Œæ‹†å¼€ç²‰åŒ…å†…æœå—ï¼Ÿä½ åˆ°åº•æ˜¯æ€ä¹ˆæƒ³çš„ï¼Ÿï¼Ÿï¼Ÿ</div>
                    </div>
                `;
            } else if (chat === 'xiaoyan') {
                header.innerText = 'å°è¨€ä¸é—²';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 15:02</div>
                    <div class="message message-them">
                        <img src="pfp/xiaoyan.jpg" class="msg-avatar" alt="å°è¨€å¤´åƒ">
                        <div class="bubble">å¢™å¥½ï¼Œå›¾ä¹¦é¦†æ‰¾äº’æ‰‡æ­å­<br>
                            è¦æ±‚ï¼š<br>
                            1.è¦æ•¢äºä¸‹æ‰‹ï¼Œä¸ç„¶æ„Ÿå—ä¸åˆ°ç—›è§‰ï¼Œä¸è¶³ä»¥æ‰“é†’æˆ‘è®©æˆ‘æ»šå»å¤ä¹ ï¼›<br>
                            2.é¢œå€¼ä¸èƒ½å¤ªé«˜ï¼Œæˆ‘æ€•è‡ªå·±çˆ½åˆ°ï¼šï¼ˆä¸è¿‡æœ€å¥½ä¹Ÿä¸è¦å¤ªä½ï¼‰<br>
                            3.åŒ»å­¦ç”Ÿï¼æ³•å­¦ç”Ÿä¼˜å…ˆï¼Œå› ä¸ºå­¦ä¹ æ€¨æ°”æ¯”è¾ƒå¤§ï¼›ç ”ç©¶ç”Ÿä¼˜å…ˆï¼Œå› ä¸ºå†™è®ºæ–‡å†™ä¸å‡ºæ¥æ€¨æ°”ä¹Ÿå¾ˆå¤§ï¼›6çº§é«˜åˆ†ä¼˜å…ˆï¼Œå› ä¸ºæˆ‘ä¸Šæ¬¡è€ƒäº†0åˆ†ï¼›æ‹’æ±‰è¯­è¨€ï¼›<br>
                            4.è¦æ±‚è¯šä¿¡äº’æ‰‡ï¼Œä¸è®¸æ‰‡å®Œæˆ‘ä¸è®©æˆ‘æ‰‡å›å»ï¼Œé™¤éæ˜¯å¹²å¹²å‡€å‡€æ¶‚äº†æŠ¤æ‰‹éœœé¦™æ°”æ¯”å·´æŒå…ˆåˆ°çš„ç¾å¥³ï¼Œé‚£ç®—å¥–åŠ±æˆ‘ï¼Œå…è®¸å•æ‰‡ã€‚<br>
                            è‡ªæˆ‘æ¨èï¼š<br>
                            1.æœ¬äººæ³¨æ„å«ç”Ÿï¼Œé¢éƒ¨å¹²çˆ½æ— ç—˜ï¼Œä¸ä¼šå¼„è„æ­å­çš„æ‰‹ï¼›<br>
                            2.æœ¬äººé¢œå€¼æ™®é€šï¼Œæ­å­è¢«æ‰‡ä¸ä¼šçˆ½åˆ°ï¼›<br>
                            3.æœ¬äººå§æ¨60ï¼Œèƒ½å¾ˆå¥½å®Œæˆäº’æ‰‡å·¥ä½œ;<br>
                            4.æœ¬äººæ˜¯ä¸€ä¸ªç”Ÿæ€§å‡‰è–„å†·æ¼ çš„188å‡†å¤‡ä¿ç ”çš„å¥³äººï¼Œé™¤äº’æ‰‡å·´æŒå·¥ä½œä»¥å¤–ä¸ä¼šå†çº ç¼ ä½ </div>
                    </div>
                    <div class="message message-me">
                        <img src="pic/shock.gif" alt="éœ‡æƒŠ" style="max-width:220px; border-radius:8px; display:block;">
                        <div class="msg-avatar me"></div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æ”¶åˆ°</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'yuhang') {
                header.innerText = 'å®‡èˆªæ¬§å·´çš„WeChat';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 15:04</div>
                    <div class="message message-them">
                        <img src="pfp/yuhang.jpg" class="msg-avatar" alt="å®‡èˆªå¤´åƒ">
                        <div class="bubble">å¢™ï¼Œç°åœ¨è¿˜èƒ½æ‰¾ä»£è¯¾å—</div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æœ‰ä»£è¯¾ç¾¤</div>
                        <div class="msg-avatar me"></div>
                    </div>
                    <div class="message message-me">
                        <img src="pic/youxiqun.jpg" alt="æ¸¸æˆç¾¤" style="max-width:220px; border-radius:8px; display:block;">
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'empurple') {
                header.innerText = 'Empurple';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 15:06</div>
                    <div class="message message-them">
                        <img src="pfp/empurple.jpg" class="msg-avatar" alt="empurpleå¤´åƒ">
                        <div class="bubble">å¢™å¥½ï¼æœ‰æ²¡æœ‰èƒ½é…é€ä¸Šæ¥¼çš„ç¾å‘³é¥­ï¼å®¿èˆå¤ªé«˜çˆ¬ä¸åŠ¨äº†</div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æ”¶åˆ°ï¼</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'zhamao') {
                header.innerText = 'ç‚¸æ¯›å¯ä¹';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 15:08</div>
                    <div class="message message-them">
                        <img src="pfp/zhamao.jpg" class="msg-avatar" alt="ç‚¸æ¯›å¯ä¹å¤´åƒ">
                        <div class="bubble">å¢™å¢™ï¼Œæ‰¾ä¸€ä¸ªå®¿èˆç¾ç”²ï¼Œé¢„ç®—40</div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">æ”¶åˆ°</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else if (chat === 'yuwensi') {
                header.innerText = 'å­¦ä¸ä¼š';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 15:10</div>
                    <div class="message message-them">
                        <img src="pfp/yuwensi.jpg" class="msg-avatar" alt="å­¦ä¸ä¼šå¤´åƒ">
                        <div class="bubble">å¢™åŒå­¦ä½ å¥½ğŸŒ¹</div>
                    </div>
                    <div class="message message-me">
                        <div class="bubble">åŒå­¦ä½ å¥½</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            } else {
                header.innerText = 'ç‹‚å–æµ·æ°´ä¸‰åƒå¨ï¼Œååˆ°æµ·æ»¡æ¢å­¦åˆ† (5)';
                area.innerHTML = `
                    <div class="chat-time">2025-12-05 14:40</div>
                    <div class="message message-them">
                        <div class="msg-avatar"></div>
                        <div class="bubble">åˆ«æ¥æ¨å¹¿äº†</div>
                    </div>
                    <div class="message message-them">
                        <div class="msg-avatar"></div>
                        <div class="bubble">æœ‰é’±ä¸èµšç‹å…«è›‹å¥¥</div>
                    </div>
                    <div class="message message-them">
                        <div class="msg-avatar"></div>
                        <div class="bubble">è€å¤šäººè¢«éª—äº†ï¼Œå’±ä¸å¹²é‚£ä¸§è‰¯å¿ƒäº‹</div>
                    </div>
                    <div class="chat-time">2025-12-05 14:40</div>
                    <div class="message message-them">
                        <div class="msg-avatar"></div>
                        <div class="bubble">è°ç»™å¯†ç æ”¹äº†</div>
                    </div>
                    <div class="message message-them">
                        <div class="msg-avatar"></div>
                        <div class="bubble">æˆ‘æ”¹çš„ï¼Œ123456789</div>
                        
                    </div>
                    <div class="message message-me">
                        <div class="bubble">å¯†ç çš„ï¼Œä½ æ”¹äº†å€’æ˜¯è¯´ä¸€å£°å•Šå¯†ç çš„</div>
                        <div class="msg-avatar me"></div>
                    </div>
                `;
            }
        }
        function switchTab(tabName) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(`${tabName}-page`).classList.add('active');

            document.querySelectorAll('.nav-icon').forEach(icon => icon.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // æ›´æ–°èŠå¤©è¾“å…¥æ¡†çš„æ˜¾ç¤ºçŠ¶æ€
            if (typeof updateChatInputVisibility === 'function') {
                updateChatInputVisibility();
            }

            // å¦‚æœåˆ‡æ¢åˆ°"æˆ‘"é¡µé¢ï¼Œç¡®ä¿è´¦å·ç®¡ç†æŒ‰é’®äº‹ä»¶å·²ç»‘å®š
            if (tabName === 'profile' && typeof bindAccountEvents === 'function') {
                bindAccountEvents();
            }
        }

        // èŠå¤©è¾“å…¥æ¡†åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function () {
            truncateNames();
            // === æ–°å¢ï¼šé»˜è®¤æ˜¾ç¤ºç¾¤èŠ ===
            // é«˜äº®ç¬¬ä¸€ä¸ªèŠå¤©é¡¹
            const firstChatItem = document.querySelector('.chat-item');
            if (firstChatItem) {
                firstChatItem.classList.add('active');
            }
            // æ˜¾ç¤ºç¾¤èŠå†…å®¹
            switchToChat('qun', firstChatItem);
            // åˆå§‹åŒ–ï¼šä¸ºæŸ’æŸ’åŠ ä¸Šçº¢ç‚¹
            showUnreadDot('qi');
            // åˆå§‹åŒ–ï¼šä¸ºğŸ¥¯ğŸ¥¯åŠ ä¸Šçº¢ç‚¹
            showUnreadDot('beiguo');
            // åˆå§‹åŒ–ï¼šä¸ºç†Šè€æ¿ä½ è¿˜æˆ‘é‡‘é³ç‰‡åŠ ä¸Šçº¢ç‚¹
            showUnreadDot('xiong');
            const chatInput = document.getElementById('chat-input');
            const chatSend = document.getElementById('chat-send');
            const messageArea = document.getElementById('chat-messages');

            // ç¡®ä¿åªåœ¨èŠå¤©é¡µé¢æ˜¾ç¤ºè¾“å…¥æ¡†
            function updateChatInputVisibility() {
                const chatPage = document.getElementById('chat-page');
                const chatInputContainer = document.querySelector('.chat-input-container');
                const momentsPage = document.getElementById('moments-page');
                const profilePage = document.getElementById('profile-page');

                if (chatPage && chatPage.classList.contains('active')) {
                    if (chatInputContainer) chatInputContainer.style.display = 'flex';
                } else {
                    if (chatInputContainer) chatInputContainer.style.display = 'none';
                }
            }

            function sendMessage() {
                const text = chatInput.value.trim();
                if (!text) return;

                // åˆ›å»ºæ–°æ¶ˆæ¯
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message message-me';

                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.textContent = text;

                const avatar = document.createElement('div');
                avatar.className = 'msg-avatar me';

                messageDiv.appendChild(bubble);
                messageDiv.appendChild(avatar);

                // æ·»åŠ åˆ°æ¶ˆæ¯åŒºåŸŸ
                messageArea.appendChild(messageDiv);

                // æ¸…ç©ºè¾“å…¥æ¡†
                chatInput.value = '';

                // === æ£€æŸ¥å‘å¸ƒå†…å®¹ï¼Œç”¨äºæ¶ˆé™¤èŠå¤©çº¢ç‚¹ ===
                // å¦‚æœå‘å¸ƒçš„æ–‡å­—åŒ…å«ç‰¹å®šå…³é”®è¯ï¼Œåˆ™éšè—å¯¹åº”çš„èŠå¤©çº¢ç‚¹
                if (text.includes('å±é™©') || text.includes('ä¸œé—¨') || text.includes('å‚»å­')) {
                    hideUnreadDot('qi'); // éšè—æŸ’æŸ’çš„çº¢ç‚¹
                }
                if (text.includes('å­¦é•¿') || text.includes('é›¶é£Ÿ')) {
                    hideUnreadDot('beiguo'); // éšè—ğŸ¥¯ğŸ¥¯çš„çº¢ç‚¹
                }
                if (text.includes('å·å¤–å–')) {
                    hideUnreadDot('xiong'); // éšè—ç†Šè€æ¿ä½ è¿˜æˆ‘é‡‘é³ç‰‡çš„çº¢ç‚¹
                }
                // æ»šåŠ¨åˆ°åº•éƒ¨
                messageArea.scrollTop = messageArea.scrollHeight;
            }

            // å‘é€æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            if (chatSend) {
                chatSend.addEventListener('click', sendMessage);
            }

            // è¾“å…¥æ¡†é”®ç›˜äº‹ä»¶
            if (chatInput) {
                chatInput.addEventListener('keydown', function (e) {
                    // æŒ‰ä¸‹Enteré”®å‘é€æ¶ˆæ¯
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                    // æŒ‰ä¸‹Shift+Enteræ¢è¡Œï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
                });
            }

            // åˆå§‹åŒ–æ—¶è°ƒç”¨ä¸€æ¬¡ï¼Œç¡®ä¿è¾“å…¥æ¡†æ˜¾ç¤ºçŠ¶æ€æ­£ç¡®
            updateChatInputVisibility();
        });

        // ç”Ÿæ´»åœˆï¼šå‘å¸ƒåŠ¨æ€äº¤äº’é€»è¾‘
        (function () {
            const input = document.getElementById('moments-input');
            const sendBtn = document.getElementById('moments-send');
            const momentsArea = document.getElementById('moments-area');

            function formatNow() {
                const d = new Date();
                const M = d.getMonth() + 1;
                const D = d.getDate();
                return `${M}æœˆ${D}æ—¥ ${d.getHours().toString().padStart(2, '0')}:${d.getMinutes().toString().padStart(2, '0')}`;
            }

            function postMoment() {
                if (!input) return;
                const txt = input.value.trim();
                if (!txt) return;
                const item = document.createElement('div');
                item.className = 'moments-item';
                const header = document.createElement('div');
                // ç©å®¶æ“æ§ä¸ºâ€œæµ·å¤§æ ¡å›­å¢™â€ï¼Œå› æ­¤å‘å¸ƒè€…æ˜¾ç¤ºä¸ºâ€œæµ·å¤§æ ¡å›­å¢™â€å¹¶è‡ªåŠ¨å¸¦åˆ é™¤æŒ‰é’®
                header.innerHTML = `<strong>æµ·å¤§æ ¡å›­å¢™</strong> ${formatNow()}`;
                const p = document.createElement('p');
                p.textContent = txt;
                item.appendChild(header);
                item.appendChild(p);
                // åˆ›å»ºè¯„è®ºåŒºåŸŸ
                const commentsContainer = document.createElement('div');
                commentsContainer.className = 'comments-container';

                // åˆ›å»ºè¯„è®ºåˆ—è¡¨
                const commentsList = document.createElement('div');
                commentsList.className = 'comments-list';

                // åˆ›å»ºè¯„è®ºè¾“å…¥æ¡†
                const commentInput = document.createElement('div');
                commentInput.className = 'comment-input-container';
                commentInput.innerHTML = `
                     <input type="text" class="comment-input" placeholder="æ·»åŠ è¯„è®º...">
                      <button class="comment-send-btn" title="å‘é€"><i class="fas fa-level-down-alt"></i></button>
                `;

                // ç»„åˆè¯„è®ºåŒºåŸŸ
                commentsContainer.appendChild(commentsList);
                commentsContainer.appendChild(commentInput);
                item.appendChild(commentsContainer);

                // æ·»åŠ åˆ é™¤æŒ‰é’®ï¼ˆå³ä¸Šè§’ï¼‰
                const trashBtn = document.createElement('button');
                trashBtn.className = 'trash-btn';
                trashBtn.title = 'åˆ é™¤';
                trashBtn.innerHTML = '<i class="fas fa-trash"></i>';
                item.appendChild(trashBtn);

                // ç»‘å®šåˆ é™¤æŒ‰é’®äº‹ä»¶
                trashBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    showConfirm(item);
                });

                // å°†æ–°å†…å®¹æ’åˆ°æœ€ä¸Šæ–¹ï¼ˆåœ¨ç°æœ‰ç¬¬ä¸€ä¸ª moments-item ä¹‹å‰ï¼‰
                if (momentsArea.firstChild) momentsArea.insertBefore(item, momentsArea.firstChild);
                else momentsArea.appendChild(item);
                // æ¸…ç©ºè¾“å…¥æ¡†
                input.value = '';
                // === æ£€æŸ¥å‘å¸ƒå†…å®¹ï¼Œç”¨äºæ¶ˆé™¤èŠå¤©çº¢ç‚¹ ===
                if (txt.includes('å±é™©') || txt.includes('ä¸œé—¨') || txt.includes('å‚»å­')) {
                    hideUnreadDot('qi'); // éšè—æŸ’æŸ’çš„çº¢ç‚¹
                }
                if (txt.includes('å­¦é•¿') || txt.includes('é›¶é£Ÿ')) {
                    hideUnreadDot('beiguo'); // éšè—ğŸ¥¯ğŸ¥¯çš„çº¢ç‚¹
                }
                if (txt.includes('å·å¤–å–')) {
                    hideUnreadDot('xiong'); // éšè—ç†Šè€æ¿ä½ è¿˜æˆ‘é‡‘é³ç‰‡çš„çº¢ç‚¹
                }
                // åˆ‡æ¢åˆ°ç”Ÿæ´»åœˆé¡µä»¥å±•ç¤ºï¼ˆå¦‚æœå½“å‰ä¸åœ¨çš„è¯ï¼‰
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById('moments-page').classList.add('active');
                document.querySelectorAll('.nav-icon').forEach(icon => icon.classList.remove('active'));
                const momentsNav = document.querySelector(".nav-icon[onclick=\"switchTab('moments')\"]");
                if (momentsNav) momentsNav.classList.add('active');
                // å‘å¸ƒåç»‘å®šè¯„è®ºäº‹ä»¶
                bindCommentEvents(item);
            }
            // è¯„è®ºåŠŸèƒ½å¤„ç†
            function handleComment(item, targetAuthor = '') {
                const commentInput = item.querySelector('.comment-input');
                const commentsList = item.querySelector('.comments-list');

                if (commentInput.value.trim() === '') return;

                const commentText = commentInput.value.trim();
                const commentItem = document.createElement('div');
                commentItem.className = 'comment-item';

                // å¦‚æœæœ‰å›å¤ç›®æ ‡ï¼Œæ˜¾ç¤º"å›å¤ @æ˜µç§°:"
                if (targetAuthor) {
                    commentItem.innerHTML = `
                        <span class="comment-author">æµ·å¤§æ ¡å›­å¢™</span> å›å¤ <span class="comment-author">@${targetAuthor}</span>: ${commentText}
                        <span class="comment-reply" onclick="replyToComment(this)">å›å¤</span>
                    `;
                } else {
                    commentItem.innerHTML = `
                        <span class="comment-author">æµ·å¤§æ ¡å›­å¢™</span>: ${commentText}
                    `;
                }

                commentsList.appendChild(commentItem);
                commentInput.value = '';
                commentInput.placeholder = 'æ·»åŠ è¯„è®º...';
                commentInput.focus();
            }

            // å›å¤è¯„è®ºåŠŸèƒ½
            window.replyToComment = function (element) {
                const commentItem = element.closest('.comment-item');
                const authorSpan = commentItem.querySelector('.comment-author');
                const targetAuthor = authorSpan.textContent.replace('@', '');

                const momentItem = commentItem.closest('.moments-item');
                const commentInput = momentItem.querySelector('.comment-input');

                commentInput.placeholder = `å›å¤ @${targetAuthor}...`;
                commentInput.focus();

                // å­˜å‚¨å½“å‰å›å¤çš„ç›®æ ‡
                momentItem._replyTarget = targetAuthor;
            }

            // ä¸ºæ¯æ¡åŠ¨æ€ç»‘å®šè¯„è®ºå‘é€äº‹ä»¶
            function bindCommentEvents(item) {
                const sendBtn = item.querySelector('.comment-send-btn');
                const commentInput = item.querySelector('.comment-input');

                if (!sendBtn || sendBtn._bound) return; // é˜²æ­¢é‡å¤ç»‘å®š

                sendBtn.addEventListener('click', function () {
                    const targetAuthor = item._replyTarget || '';
                    handleComment(item, targetAuthor);
                    item._replyTarget = ''; // æ¸…é™¤å›å¤ç›®æ ‡
                });

                commentInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        const targetAuthor = item._replyTarget || '';
                        handleComment(item, targetAuthor);
                        item._replyTarget = ''; // æ¸…é™¤å›å¤ç›®æ ‡
                    }
                });

                sendBtn._bound = true; // æ ‡è®°å·²ç»‘å®š
            }
            if (sendBtn) {
                sendBtn.addEventListener('click', postMoment);
            }
            if (input) {
                input.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        postMoment();
                    }
                });
            }
            // ä¸ºå·²å­˜åœ¨æˆ–åç»­åˆ›å»ºçš„ç”±â€œæµ·å¤§æ ¡å›­å¢™â€å‘å¸ƒçš„é¡¹æ·»åŠ åƒåœ¾æ¡¶ï¼ˆå³ä¸‹è§’ï¼‰å¹¶ç»‘å®šäº‹ä»¶
            function bindTrashButtons() {
                const items = document.querySelectorAll('#moments-area .moments-item');
                items.forEach(it => {
                    const header = it.querySelector('div');
                    // åªä¸º"æµ·å¤§æ ¡å›­å¢™"å‘å¸ƒçš„åŠ¨æ€å¤„ç†åˆ é™¤æŒ‰é’®
                    if (header && header.textContent && header.textContent.includes('æµ·å¤§æ ¡å›­å¢™')) {
                        // 
                        if (!it.querySelector('.trash-btn')) {
                            const btn = document.createElement('button');
                            btn.className = 'trash-btn';
                            btn.title = 'åˆ é™¤';
                            btn.innerHTML = '<i class="fas fa-trash"></i>';
                            it.appendChild(btn);
                        }
                        // ä¸ºåˆ é™¤æŒ‰é’®ç»‘å®šäº‹ä»¶ï¼ˆæ— è®ºæ–°æ—§ï¼‰
                        const trashBtn = it.querySelector('.trash-btn');
                        if (trashBtn && !trashBtn._bound) {
                            trashBtn.addEventListener('click', function (e) {
                                e.stopPropagation();
                                showConfirm(it);
                            });
                            trashBtn._bound = true; // æ ‡è®°å·²ç»‘å®š
                        }
                    }
                    // åŠ¨æ€ç»‘å®šè¯„è®ºäº‹ä»¶
                    bindCommentEvents(it);
                });
            }

            // ç¡®è®¤å¯¹è¯æ¡†é€»è¾‘
            let pendingDelete = null;
            function showConfirm(targetItem) {
                pendingDelete = targetItem;
                const overlay = document.getElementById('confirm-overlay');
                if (overlay) overlay.classList.remove('hidden');
            }
            function hideConfirm() {
                pendingDelete = null;
                const overlay = document.getElementById('confirm-overlay');
                if (overlay) overlay.classList.add('hidden');
            }

            function doDelete() {
                if (pendingDelete && pendingDelete.parentNode) {
                    pendingDelete.parentNode.removeChild(pendingDelete);
                }
                hideConfirm();
            }
            // åˆå§‹åŒ–ï¼šç»‘å®šå·²æœ‰çš„åƒåœ¾æ¡¶å¹¶ç»‘å®šç¡®è®¤å¯¹è¯æ¡†æŒ‰é’®ï¼ˆåœ¨ DOMContentLoaded ä¸­æ‰§è¡Œï¼Œç¡®ä¿å…ƒç´ å­˜åœ¨ï¼‰
            document.addEventListener('DOMContentLoaded', function () {
                // ä¸ºç°æœ‰ç”Ÿæ´»åœˆåŠ¨æ€æ·»åŠ è¯„è®ºåŠŸèƒ½
                const existingMoments = document.querySelectorAll('#moments-area .moments-item');
                existingMoments.forEach(item => {
                    // æ£€æŸ¥æ˜¯å¦å·²æœ‰è¯„è®ºåŒºåŸŸ
                    if (!item.querySelector('.comments-container')) {
                        // åˆ›å»ºè¯„è®ºåŒºåŸŸ
                        const commentsContainer = document.createElement('div');
                        commentsContainer.className = 'comments-container';

                        const commentsList = document.createElement('div');
                        commentsList.className = 'comments-list';

                        const commentInput = document.createElement('div');
                        commentInput.className = 'comment-input-container';
                        commentInput.innerHTML = `
                            <input type="text" class="comment-input" placeholder="æ·»åŠ è¯„è®º...">
                            <button class="comment-send-btn" title="å‘é€"><i class="fas fa-level-down-alt"></i></button>
                        `;

                        commentsContainer.appendChild(commentsList);
                        commentsContainer.appendChild(commentInput);

                        // æ’å…¥åˆ°åˆ é™¤æŒ‰é’®ä¹‹å‰
                        const trashBtn = item.querySelector('.trash-btn');
                        if (trashBtn) {
                            item.insertBefore(commentsContainer, trashBtn);
                        } else {
                            item.appendChild(commentsContainer);
                        }

                        // ç»‘å®šè¯„è®ºäº‹ä»¶
                        bindCommentEvents(item);
                    }
                });
                bindTrashButtons();

                const delBtn = document.getElementById('confirm-delete');
                const cancelBtn = document.getElementById('confirm-cancel');
                if (delBtn) delBtn.addEventListener('click', doDelete);
                if (cancelBtn) cancelBtn.addEventListener('click', hideConfirm);
                const confirmOverlay = document.getElementById('confirm-overlay');
                if (confirmOverlay) {
                    confirmOverlay.addEventListener('click', function (event) {
                        if (event.target === confirmOverlay || event.target.classList.contains('overlay-backdrop')) {
                            hideConfirm();
                        }
                    });
                }
                // ç»‘å®šè´¦å·ç®¡ç†ã€ç™»å‡ºä¸ç™»å½•ç›¸å…³æŒ‰é’®
                function bindAccountEvents() {
                    const accountBtn = document.getElementById('account-manage-btn');
                    const accountOverlay = document.getElementById('account-overlay');
                    const switchAccount = document.getElementById('switch-account');
                    const logoutAccount = document.getElementById('logout-account');

                    if (accountBtn) {
                        accountBtn.addEventListener('click', function (event) {
                            event.stopPropagation();
                            accountOverlay.classList.remove('hidden');
                        });
                    }
                    if (accountOverlay) {
                        accountOverlay.addEventListener('click', function (event) {
                            if (event.target.classList.contains('overlay-backdrop')) {
                                accountOverlay.classList.add('hidden');
                            }
                        });
                    }
                    if (switchAccount) {
                        switchAccount.addEventListener('click', function (event) {
                            event.stopPropagation();
                            // ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µ
                            window.location.href = 'login.html';
                        });
                    }
                    if (logoutAccount) {
                        logoutAccount.addEventListener('click', function (event) {
                            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å¹²æ‰°
                            // ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µ
                            window.location.href = 'login.html';
                        });
                    }
                }

                // åˆå§‹ç»‘å®šä¸€æ¬¡
                bindAccountEvents();

            });
            // æ¯æ¬¡å‘å¸ƒä¹Ÿæ£€æŸ¥æ˜¯å¦éœ€è¦ç»‘å®šï¼ˆå‘å¸ƒæ—¶ä¼šæ’å…¥æ–°èŠ‚ç‚¹ï¼‰
            const originalPost = postMoment;
            // override postMoment variable reference not needed because we create items only as 'æˆ‘'
        })();

    </script>
    <!-- è´¦å·ç®¡ç†æ¨¡æ€ -->
    <div id="account-overlay" class="account-overlay hidden" aria-hidden="true">
        <div class="overlay-backdrop"></div>
        <div class="account-modal">
            <div class="account-list">
                <div class="account-item" id="switch-account">åˆ‡æ¢è´¦å·</div>
                <div class="account-item danger" id="logout-account">é€€å‡ºè´¦å·</div>
            </div>
        </div>
    </div>




    <!-- åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†ï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div id="confirm-overlay" class="confirm-overlay hidden" aria-hidden="true">
        <div class="confirm-modal" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
            <div id="confirm-title" class="confirm-body">ç¡®å®šåˆ é™¤å—</div>
            <div class="confirm-footer">
                <button id="confirm-delete" class="confirm-btn delete">åˆ é™¤</button>
                <button id="confirm-cancel" class="confirm-btn">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
</body>

</html>